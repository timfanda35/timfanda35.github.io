<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge,chrome=1">
  <title>form_for 與 strong parameter 的關係 &middot; Bear Su&#39;s blog -  Running Bear!!! </title>
  <meta name="generator" content="Hugo 0.53" />
  <meta name="description" content="Running Bear!!!"> 

  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="form_for 與 strong parameter 的關係"/>
<meta name="twitter:description" content="form_for 是用 Rails 做網頁很常用的 Helper 方法，他的方便之處在於很輕鬆的產生與 Model 對應的 HTML 表單。
大部份的時候都會將使用者輸入的資料，用 Hash 表示 Model 的方式傳送到伺服器上。
但是有兩個問題：
 伺服器直接依照傳入的參數更新資料，如果有心人士偷塞了 Model 有的欄位，資料就會被改掉。 親自寫判斷去過濾傳入的參數，如果 Model 的種類一多，欄位一多就會變得很麻煩。  這邊可以用 strong parameter 來很簡單地過濾掉，傳入的 Model 參數中含有非預期的參數。
假設 Foo 定義如下，其中 security_field 欄位並不想被隨意修改，所以沒有呈現在表單上。
# schema create_table &quot;foos&quot;, force: :cascade do |t| t.string &quot;name&quot; t.integer &quot;bar&quot; t.string &quot;security_field&quot; t.datetime &quot;created_at&quot;, null: false t.datetime &quot;updated_at&quot;, null: false end  但有心人士仍然可以發送這樣的請求給伺服器，試圖去修改資料庫的值。
{ &quot;id&quot;: 1, &quot;foo&quot;: { &quot;name&quot;: &quot;foo&quot;, &quot;bar&quot;: 1, &quot;security_field&quot;: &quot;bad value&quot; } }  在這邊最簡單的方法就是用 strong parameter 來過濾，在 Controller 中寫一個 private method，要更新 Modle 時就使用該 method 來取得過濾後的參數來更新。"/>

  <meta property="og:title" content="form_for 與 strong parameter 的關係" />
<meta property="og:description" content="form_for 是用 Rails 做網頁很常用的 Helper 方法，他的方便之處在於很輕鬆的產生與 Model 對應的 HTML 表單。
大部份的時候都會將使用者輸入的資料，用 Hash 表示 Model 的方式傳送到伺服器上。
但是有兩個問題：
 伺服器直接依照傳入的參數更新資料，如果有心人士偷塞了 Model 有的欄位，資料就會被改掉。 親自寫判斷去過濾傳入的參數，如果 Model 的種類一多，欄位一多就會變得很麻煩。  這邊可以用 strong parameter 來很簡單地過濾掉，傳入的 Model 參數中含有非預期的參數。
假設 Foo 定義如下，其中 security_field 欄位並不想被隨意修改，所以沒有呈現在表單上。
# schema create_table &quot;foos&quot;, force: :cascade do |t| t.string &quot;name&quot; t.integer &quot;bar&quot; t.string &quot;security_field&quot; t.datetime &quot;created_at&quot;, null: false t.datetime &quot;updated_at&quot;, null: false end  但有心人士仍然可以發送這樣的請求給伺服器，試圖去修改資料庫的值。
{ &quot;id&quot;: 1, &quot;foo&quot;: { &quot;name&quot;: &quot;foo&quot;, &quot;bar&quot;: 1, &quot;security_field&quot;: &quot;bad value&quot; } }  在這邊最簡單的方法就是用 strong parameter 來過濾，在 Controller 中寫一個 private method，要更新 Modle 時就使用該 method 來取得過濾後的參數來更新。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://timfanda35.github.io/2015/07/30/form-for-and-strong-relationship-parameter/" /><meta property="article:published_time" content="2015-07-30T13:01:00&#43;08:00"/>
<meta property="article:modified_time" content="2015-07-30T13:01:00&#43;08:00"/>


  <!-- RSS autodiscovery --> 

  
<meta itemprop="name" content="form_for 與 strong parameter 的關係">
<meta itemprop="description" content="form_for 是用 Rails 做網頁很常用的 Helper 方法，他的方便之處在於很輕鬆的產生與 Model 對應的 HTML 表單。
大部份的時候都會將使用者輸入的資料，用 Hash 表示 Model 的方式傳送到伺服器上。
但是有兩個問題：
 伺服器直接依照傳入的參數更新資料，如果有心人士偷塞了 Model 有的欄位，資料就會被改掉。 親自寫判斷去過濾傳入的參數，如果 Model 的種類一多，欄位一多就會變得很麻煩。  這邊可以用 strong parameter 來很簡單地過濾掉，傳入的 Model 參數中含有非預期的參數。
假設 Foo 定義如下，其中 security_field 欄位並不想被隨意修改，所以沒有呈現在表單上。
# schema create_table &quot;foos&quot;, force: :cascade do |t| t.string &quot;name&quot; t.integer &quot;bar&quot; t.string &quot;security_field&quot; t.datetime &quot;created_at&quot;, null: false t.datetime &quot;updated_at&quot;, null: false end  但有心人士仍然可以發送這樣的請求給伺服器，試圖去修改資料庫的值。
{ &quot;id&quot;: 1, &quot;foo&quot;: { &quot;name&quot;: &quot;foo&quot;, &quot;bar&quot;: 1, &quot;security_field&quot;: &quot;bad value&quot; } }  在這邊最簡單的方法就是用 strong parameter 來過濾，在 Controller 中寫一個 private method，要更新 Modle 時就使用該 method 來取得過濾後的參數來更新。">


<meta itemprop="datePublished" content="2015-07-30T13:01:00&#43;08:00" />
<meta itemprop="dateModified" content="2015-07-30T13:01:00&#43;08:00" />
<meta itemprop="wordCount" content="125">



<meta itemprop="keywords" content="" />

  <link href="https://fonts.googleapis.com/css?family=Lato:400" rel="stylesheet">
  <link rel="stylesheet" href="https://timfanda35.github.io/css/style.css">
  <script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "WebSite",
  "name": "Bear Su&#39;s blog",
  "url": "https://timfanda35.github.io/2015/07/30/form-for-and-strong-relationship-parameter/"
}
</script>

</head>

<body>
  <header class="gheader">
  <div class="container">
    <nav class="navbar ">
      <div class="navbar-brand">
        <a class="navbar-item" href="https://timfanda35.github.io">
          <h1 class="brand">Bear Su&#39;s blog</h1>
        </a>

        <div class="navbar-burger burger" data-target="navMenubd-example">
          <span></span>
          <span></span>
          <span></span>
        </div>
      </div>

      <div id="navMenubd-example" class="navbar-menu">
        <div class="navbar-start">
          
          <a class="navbar-item" href="/categories/">
            Categories
          </a>
          
        </div>
      </div>
    </nav>
  </div>
</header>


  <div class="main-content">
    <div class="container">
      
  <article class="post">
    <header class="post-header">
      <h1 class="title">form_for 與 strong parameter 的關係</h1>
      <div class="meta">
        <time class="pub-time"  datetime="2015-07-30T13:01:00&#43;08:00">
          2015.07.30
        </time>
        <div class="terms">
          
          <div class="categories">
            
              <a class="categories-item" href="/categories/ruby">ruby</a>
            
              <a class="categories-item" href="/categories/rails">rails</a>
            
          </div>
          
          
        </div>
      </div>
    </header>
    <div class="post-body">
      

<p><code>form_for</code> 是用 Rails 做網頁很常用的 Helper 方法，他的方便之處在於很輕鬆的產生與 Model 對應的 HTML 表單。</p>

<p>大部份的時候都會將使用者輸入的資料，用 Hash 表示 Model 的方式傳送到伺服器上。</p>

<p>但是有兩個問題：</p>

<ul>
<li>伺服器直接依照傳入的參數更新資料，如果有心人士偷塞了 Model 有的欄位，資料就會被改掉。</li>
<li>親自寫判斷去過濾傳入的參數，如果 Model 的種類一多，欄位一多就會變得很麻煩。</li>
</ul>

<p>這邊可以用 <code>strong parameter</code> 來很簡單地過濾掉，傳入的 Model 參數中含有非預期的參數。</p>

<p>假設 Foo 定義如下，其中 <code>security_field</code> 欄位並不想被隨意修改，所以沒有呈現在表單上。</p>

<pre><code class="language-ruby"># schema
create_table &quot;foos&quot;, force: :cascade do |t|
  t.string   &quot;name&quot;
  t.integer  &quot;bar&quot;
  t.string   &quot;security_field&quot;
  t.datetime &quot;created_at&quot;, null: false
  t.datetime &quot;updated_at&quot;, null: false
end
</code></pre>

<p>但有心人士仍然可以發送這樣的請求給伺服器，試圖去修改資料庫的值。</p>

<pre><code class="language-json">{
  &quot;id&quot;: 1,
  &quot;foo&quot;: {
    &quot;name&quot;: &quot;foo&quot;,
    &quot;bar&quot;: 1,
    &quot;security_field&quot;: &quot;bad value&quot;
  }
}
</code></pre>

<p>在這邊最簡單的方法就是用 <code>strong parameter</code> 來過濾，在 <code>Controller</code> 中寫一個 private method，要更新 Modle 時就使用該 method 來取得過濾後的參數來更新。</p>

<pre><code class="language-ruby">class FoosController &lt; ApplicationController
  ...
  
  private
  
  def foo_params
    # 只允許通過 :name, :bar 參數
  	params.require(:foo).permit(:name, :bar)
  end
end
</code></pre>

<p>如果有參數包含關聯 Modle，即巢狀表單，會寫成如下：</p>

<pre><code class="language-ruby"># 只允許通過 :name, :bar 以及關聯的 member :id :name 參數
# 記得要允許關聯 Model 的 :id 參數，不然會無法正確更新
params.require(:foo).permit(:name, :bar, member_attributes:[:id, :name])
</code></pre>

<h2 id="參考資料">參考資料</h2>

<p><a href="http://rocodev.gitbooks.io/rails-102/content/chapter1-mvc/c/strong_parameters.html">Rails102</a>
<a href="http://guides.rubyonrails.org/action_controller_overview.html#strong-parameters">Rails Guide</a></p>

    </div>
    <footer class="post-footer">
      
      <div class="share">
        
      </div>

      <div class="pagenation">
        <ul class="pagenation-list">
          
          <li class="pager previous">
            <a href="https://timfanda35.github.io/2015/07/30/activerecord-has-associated/" data-toggle="tooltip" data-placement="top" title="ActiveRecord has_many :through 關聯">&larr; Previous Post</a>
          </li>
          
          
          <li class="pager next">
            <a href="https://timfanda35.github.io/2015/07/30/helper-method-to-use/" data-toggle="tooltip" data-placement="top" title="helper 的使用方法">Next Post &rarr;</a>
          </li>
          
        </ul>
      </div>
    </footer>
  </article>

  
  <article class="related"></article>

  <script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage": {
    "@type": "NewsArticle",
    "@id": "https://timfanda35.github.io/2015/07/30/form-for-and-strong-relationship-parameter/",
    "headline": " form_for 是用 Rails 做網頁很常用的 Helper 方法，他的方便之處在於很輕鬆的產生與 Model 對應的 HTML 表單。大部份的時候都會將使用者輸入的資料，用 Hash 表示 Model 的方式傳送",
    "author": "Bear Su",
    "publisher": {
      "@type": "Organization",
      "name": "Bear Su",
      "logo": ""
    },
    "image": "",
    "datePublished": "2015-07-30"
  },
  "headline": " form_for 是用 Rails 做網頁很常用的 Helper 方法，他的方便之處在於很輕鬆的產生與 Model 對應的 HTML 表單。大部份的時候都會將使用者輸入的資料，用 Hash 表示 Model 的方式傳送",
  "alternativeHeadline": "Bear Su&#39;s blog",
  "datePublished": "2015-07-30",
  "dateModified": "2015-07-30",
  "url": "https://timfanda35.github.io/2015/07/30/form-for-and-strong-relationship-parameter/",
  "wordCount": "125",
  "author": {
    "@type": "Person",
    "name": "Bear Su"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Bear Su"
  },
  "image": "",
  "genre": "rubyrails",
  
  "description": ""
}
</script>

  <script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Person",
  "@id": "https://timfanda35.github.io/2015/07/30/form-for-and-strong-relationship-parameter/",
  "name": "Bear Su"
}
</script>


    </div>
  </div>

  <footer class="gfooter">
  <div class="inner">
    <div class="container">
      <p class="copy"><small>(c) 2019 Bear Su&#39;s blog</small></p>

      <nav class="footer-nav">
        <div class="inner">
          
        </div>
      </nav>
    </div>
  </div>
</footer>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-5708312-7', 'auto');
	
	ga('send', 'pageview');
}
</script>


<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script src="https://timfanda35.github.io/js/script.js"></script>

</body>
</html>
