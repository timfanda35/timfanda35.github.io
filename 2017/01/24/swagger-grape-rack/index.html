<!doctype html><html lang=en-us>
<head>
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png>
<link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png>
<link rel=manifest href=/site.webmanifest>
<link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5>
<meta name=msapplication-TileColor content="#da532c">
<meta name=theme-color content="#ffffff">
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=x-ua-compatible content="ie=edge,chrome=1">
<title>swagger + grape + rack &#183; Bear Su's Blog - Running Bear!!! </title>
<meta name=generator content="Hugo 0.92.0">
<meta name=description content="Running Bear!!!">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://blog.bear-su.dev/images/bear.jpeg">
<meta name=twitter:title content="swagger + grape + rack">
<meta name=twitter:description content="常常聽到 swagger 跟 grape 的名字
所以用一個很陽春的專案練習一下要如何使用">
<meta property="og:title" content="swagger + grape + rack">
<meta property="og:description" content="常常聽到 swagger 跟 grape 的名字
所以用一個很陽春的專案練習一下要如何使用">
<meta property="og:type" content="article">
<meta property="og:url" content="https://blog.bear-su.dev/2017/01/24/swagger-grape-rack/"><meta property="og:image" content="https://blog.bear-su.dev/images/bear.jpeg"><meta property="article:section" content>
<meta property="article:published_time" content="2017-01-24T06:43:00+08:00">
<meta property="article:modified_time" content="2017-01-24T06:43:00+08:00">
<link href rel=alternate type=application/rss+xml title="Bear Su's Blog">
<link href rel=feed type=application/rss+xml title="Bear Su's Blog">
<meta itemprop=name content="swagger + grape + rack">
<meta itemprop=description content="常常聽到 swagger 跟 grape 的名字
所以用一個很陽春的專案練習一下要如何使用"><meta itemprop=datePublished content="2017-01-24T06:43:00+08:00">
<meta itemprop=dateModified content="2017-01-24T06:43:00+08:00">
<meta itemprop=wordCount content="160"><meta itemprop=image content="https://blog.bear-su.dev/images/bear.jpeg">
<meta itemprop=keywords content>
<link href="https://fonts.googleapis.com/css?family=Lato:400" rel=stylesheet>
<link rel=stylesheet href=https://blog.bear-su.dev/css/style.css>
<script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","name":"Bear Su\u0027s Blog","url":"https:\/\/blog.bear-su.dev\/2017\/01\/24\/swagger-grape-rack\/"}</script>
</head>
<body>
<header class=gheader>
<div class=container>
<nav class=navbar>
<div class=navbar-brand>
<a class=navbar-item href=https://blog.bear-su.dev>
<p class=brand>Bear Su's Blog</p>
</a>
<div class="navbar-burger burger" data-target=navMenubd-example>
<span></span>
<span></span>
<span></span>
</div>
</div>
<div id=navMenubd-example class=navbar-menu>
<div class=navbar-start>
<a class=navbar-item href=/categories/>
Categories
</a>
<a class=navbar-item href=https://github.com/timfanda35>
GitHub
</a>
<a class=navbar-item href=https://www.linkedin.com/in/bearsu>
Linkedin
</a>
<a class=navbar-item href=https://twitter.com/Fandayo>
Twitter
</a>
</div>
</div>
</nav>
</div>
</header>
<div class=main-content>
<div class=container>
<article class=post>
<header class=post-header>
<h1 class=title>swagger + grape + rack</h1>
<div class=meta>
<time class=pub-time datetime=2017-01-24T06:43:00+08:00>
2017.01.24
</time>
<div class=terms>
<div class=categories>
<a class=categories-item href=/categories/ruby>ruby</a>
</div>
</div>
</div>
</header>
<div class=post-body>
<div class=toc-wrap>
<h2>Table of Contents</h2>
<nav id=TableOfContents>
<ul>
<li><a href=#使用到的-gem>使用到的 Gem:</a></li>
<li><a href=#其他使用到的-repo>其他使用到的 Repo</a></li>
<li><a href=#開發>開發</a></li>
<li><a href=#swagger-ui>Swagger UI</a></li>
<li><a href=#execute>Execute</a></li>
</ul>
</nav>
</div>
<p>常常聽到 <a href=http://swagger.io/>swagger</a> 跟 <a href=https://github.com/ruby-grape/grape>grape</a> 的名字</p>
<p>所以用一個很陽春的<a href=https://github.com/timfanda35/test-grape-api>專案</a>練習一下要如何使用</p>
<h2 id=使用到的-gem>使用到的 Gem: <a href=#%e4%bd%bf%e7%94%a8%e5%88%b0%e7%9a%84-gem>¶</a></h2>
<hr>
<ul>
<li><a href=https://github.com/ruby-grape/grape>grape</a> API 框架</li>
<li><a href=https://github.com/ruby-grape/grape-swagger>grape-swagger</a> API 文件產生器</li>
<li><a href=https://github.com/kmikael/vienna>vienna</a> 簡單設定讓 Rack 處理public 靜態文件</li>
</ul>
<h2 id=其他使用到的-repo>其他使用到的 Repo <a href=#%e5%85%b6%e4%bb%96%e4%bd%bf%e7%94%a8%e5%88%b0%e7%9a%84-repo>¶</a></h2>
<hr>
<ul>
<li><a href=https://github.com/swagger-api/swagger-ui>swagger-ui</a> API 文件瀏覽前端</li>
</ul>
<h2 id=開發>開發 <a href=#%e9%96%8b%e7%99%bc>¶</a></h2>
<hr>
<p>用 <a href=https://github.com/ruby-grape/grape>grape</a> 開發 API，以及加上 swagger 文件支援，這些都照著官方文件走就可以了</p>
<p>由於要用 rack 同時跑 API 與 <a href=https://github.com/swagger-api/swagger-ui>swagger-ui</a>，所以在 <code>config.ru</code> 用了 <a href=https://github.com/kmikael/vienna>vienna</a></p>
<p><a href=https://github.com/kmikael/vienna>vienna</a> 可以讓 rack 套用 <code>public</code> 目錄下的靜態檔案成為網站的一部份</p>
<p><code>config.ru 範例</code></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>require <span style=color:#e6db74>&#39;bundler/setup&#39;</span>
<span style=color:#66d9ef>Bundler</span><span style=color:#f92672>.</span>require

require <span style=color:#e6db74>&#34;vienna&#34;</span>
require <span style=color:#e6db74>&#34;grape&#34;</span>
require <span style=color:#e6db74>&#34;grape-swagger&#34;</span>
require_relative <span style=color:#e6db74>&#34;twitter/api.rb&#34;</span>

<span style=color:#66d9ef>module</span> API
  <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Root</span> <span style=color:#f92672>&lt;</span> <span style=color:#66d9ef>Grape</span><span style=color:#f92672>::</span><span style=color:#66d9ef>API</span>
    format <span style=color:#e6db74>:json</span>

    <span style=color:#75715e># CORS</span>
    before <span style=color:#66d9ef>do</span>
      header<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;Access-Control-Allow-Origin&#39;</span><span style=color:#f92672>]</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;*&#39;</span>
      header<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;Access-Control-Request-Method&#39;</span><span style=color:#f92672>]</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;*&#39;</span>
    <span style=color:#66d9ef>end</span>

    mount <span style=color:#66d9ef>Twitter</span><span style=color:#f92672>::</span><span style=color:#66d9ef>API</span>
    add_swagger_documentation
  <span style=color:#66d9ef>end</span>
<span style=color:#66d9ef>end</span>

<span style=color:#75715e># 除了 API 還要跑 public 下的靜態檔案</span>
run <span style=color:#66d9ef>Rack</span><span style=color:#f92672>::</span><span style=color:#66d9ef>Cascade</span><span style=color:#f92672>.</span>new <span style=color:#f92672>[</span><span style=color:#66d9ef>API</span><span style=color:#f92672>::</span><span style=color:#66d9ef>Root</span>, <span style=color:#66d9ef>Vienna</span><span style=color:#f92672>]</span>
</code></pre></div><h2 id=swagger-ui>Swagger UI <a href=#swagger-ui>¶</a></h2>
<hr>
<p>從 <a href=https://github.com/swagger-api/swagger-ui>swagger-ui</a> 下載壓縮檔</p>
<p>把 <code>swagger-ui/dist</code> 下的檔案複製到專案的 <code>public</code> 目錄 下</p>
<p>打開 <code>index.html</code> 將</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>url</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>url</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1</span>) {
  <span style=color:#a6e22e>url</span> <span style=color:#f92672>=</span> decodeURIComponent(<span style=color:#a6e22e>url</span>[<span style=color:#ae81ff>1</span>]);
} <span style=color:#66d9ef>else</span> {
  <span style=color:#a6e22e>url</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;http://petstore.swagger.io/v2/swagger.json&#34;</span>;
}
</code></pre></div><p>修改成</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>url</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>url</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1</span>) {
  <span style=color:#a6e22e>url</span> <span style=color:#f92672>=</span> decodeURIComponent(<span style=color:#a6e22e>url</span>[<span style=color:#ae81ff>1</span>]);
} <span style=color:#66d9ef>else</span> {
  <span style=color:#a6e22e>url</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;http://localhost:9292/swagger_doc.json&#34;</span>;
}
</code></pre></div><h2 id=execute>Execute <a href=#execute>¶</a></h2>
<hr>
<p>Run command:</p>
<pre tabindex=0><code>bundle exec rackup
</code></pre><p>打開瀏覽器瀏覽 <code>http://localhost:9292/</code> 就可以看到 swagger 風格的 API 文件了！</p>
</div>
<footer class=post-footer>
<hr>
<div style=margin-top:2.5rem>
<div style=display:flex;justify-content:center;width:100%>
<p style=color:gray>
如果覺得這篇文章對您有所幫助，歡迎贊助我一杯咖啡 ☕️
</p>
</div>
<div style=display:flex;justify-content:center;width:100%>
<p style=color:gray>
祝您有美好的一天 ❤️
</p>
</div>
<div style=display:flex;justify-content:center;width:100%;margin-top:1rem>
<script type=text/javascript src=https://cdnjs.buymeacoffee.com/1.0.0/button.prod.min.js data-name=bmc-button data-slug=timfanda35 data-color=#FFDD00 data-emoji data-font=Bree data-text="Buy me a coffee" data-outline-color=#000000 data-font-color=#000000 data-coffee-color=#ffffff></script>
</div>
</div>
<hr>
<div style=margin-top:1rem>
<script src=https://utteranc.es/client.js repo=timfanda35/timfanda35.github.io issue-term=pathname label=comment theme=github-light crossorigin=anonymous async></script>
</div>
<div class=share>
</div>
<div class=pagenation>
<ul class=pagenation-list>
<li class="pager previous">
<a href=https://blog.bear-su.dev/2017/01/05/start-ruby-project-with-bundler/ data-toggle=tooltip data-placement=top title="Start ruby project with bundler">&larr; Previous Post</a>
</li>
<li class="pager next">
<a href=https://blog.bear-su.dev/2017/02/04/logger-tip/ data-toggle=tooltip data-placement=top title="logger tip">Next Post &rarr;</a>
</li>
</ul>
</div>
</footer>
</article>
<article class=related></article>
<script type=application/ld+json>{"@context":"http://schema.org","@type":"NewsArticle","mainEntityOfPage":{"@type":"NewsArticle","@id":"https:\/\/blog.bear-su.dev\/2017\/01\/24\/swagger-grape-rack\/","headline":"常常聽到 swagger 跟 grape 的名字所以用一個很陽春的專案練習一下要如何使用使用到的 Gem: ¶  grape API 框架 grape-swagger API 文件產生器 vienna 簡單設定讓 Rac","author":"Bear Su","publisher":{"@type":"Organization","name":"Bear Su","logo":""},"image":"","datePublished":"2017-01-24"},"headline":"常常聽到 swagger 跟 grape 的名字所以用一個很陽春的專案練習一下要如何使用使用到的 Gem: ¶  grape API 框架 grape-swagger API 文件產生器 vienna 簡單設定讓 Rac","alternativeHeadline":"Bear Su\u0027s Blog","datePublished":"2017-01-24","dateModified":"2017-01-24","url":"https:\/\/blog.bear-su.dev\/2017\/01\/24\/swagger-grape-rack\/","wordCount":"160","author":{"@type":"Person","name":"Bear Su"},"publisher":{"@type":"Organization","name":"Bear Su"},"image":"","genre":"ruby","description":""}</script>
<script type=application/ld+json>{"@context":"http://schema.org","@type":"Person","@id":"https:\/\/blog.bear-su.dev\/2017\/01\/24\/swagger-grape-rack\/","name":"Bear Su"}</script>
</div>
</div>
<footer class=gfooter>
<div class=inner>
<div class=container>
<p class=copy>
<small>Copyright © 2015 - 2022 Bear Su's Blog</small>
<small> | 本部落格有使用 Google Analytic 及 Cookie</small>
</p>
<nav class=footer-nav>
<div class=inner>
</div>
</nav>
</div>
</div>
</footer>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-KJXNT5CQCS"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-KJXNT5CQCS',{anonymize_ip:!1})}</script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://blog.bear-su.dev/js/script.js></script>
</body>
</html>